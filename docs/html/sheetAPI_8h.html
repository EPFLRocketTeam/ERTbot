<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ERTbot: include/sheetAPI.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ERTbot
   </div>
   <div id="projectbrief">Bot used to automate and enhance certain processes at the EPFL Rocket Team</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">sheetAPI.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="sheetAPI_8h__dep__incl.png" border="0" usemap="#ainclude_2sheetAPI_8hdep" alt=""/></div>
</div>
</div>
<p><a href="sheetAPI_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a47426036fb44318f0899346238a48b02"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sheetAPI_8h.html#a47426036fb44318f0899346238a48b02">sheetApi</a> (char *query, char *url, char *requestType)</td></tr>
<tr class="memdesc:a47426036fb44318f0899346238a48b02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Makes an API request to a specified URL using the provided query and request type.  <a href="sheetAPI_8h.html#a47426036fb44318f0899346238a48b02">More...</a><br /></td></tr>
<tr class="separator:a47426036fb44318f0899346238a48b02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64ea3261973ef7a6fac53badd1ef0835"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sheetAPI_8h.html#a64ea3261973ef7a6fac53badd1ef0835">batchUpdateSheet</a> (char *sheetId, char *range, char *values)</td></tr>
<tr class="memdesc:a64ea3261973ef7a6fac53badd1ef0835"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs a batch update on a Google Sheet by sending a POST request with specified parameters.  <a href="sheetAPI_8h.html#a64ea3261973ef7a6fac53badd1ef0835">More...</a><br /></td></tr>
<tr class="separator:a64ea3261973ef7a6fac53badd1ef0835"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca34990c43115f79931b7f989130798f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sheetAPI_8h.html#aca34990c43115f79931b7f989130798f">batchGetSheet</a> (char *sheetId, char *range)</td></tr>
<tr class="memdesc:aca34990c43115f79931b7f989130798f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves data from a specified range in a Google Sheet by sending a GET request.  <a href="sheetAPI_8h.html#aca34990c43115f79931b7f989130798f">More...</a><br /></td></tr>
<tr class="separator:aca34990c43115f79931b7f989130798f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82b6dc3d32e005909fad4c54a0de845b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sheetAPI_8h.html#a82b6dc3d32e005909fad4c54a0de845b">refreshOAuthToken</a> ()</td></tr>
<tr class="memdesc:a82b6dc3d32e005909fad4c54a0de845b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refreshes the OAuth token by sending a POST request to the Google OAuth 2.0 server.  <a href="sheetAPI_8h.html#a82b6dc3d32e005909fad4c54a0de845b">More...</a><br /></td></tr>
<tr class="separator:a82b6dc3d32e005909fad4c54a0de845b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="aca34990c43115f79931b7f989130798f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca34990c43115f79931b7f989130798f">&#9670;&nbsp;</a></span>batchGetSheet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void batchGetSheet </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>sheetId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>range</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves data from a specified range in a Google Sheet by sending a GET request. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sheetId</td><td>Pointer to the string containing the ID of the Google Sheet to be accessed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">range</td><td>Pointer to the string specifying the range of cells to retrieve.</td></tr>
  </table>
  </dd>
</dl>
<p>This function constructs a URL for a GET request to the Google Sheets API by modifying a template URL to include the provided <code>sheetId</code> and <code>range</code>. The constructed URL is then passed to the <code>sheetAPI</code> function, which handles the API request. Since this is a GET request, the query string is left empty. After the request is completed, the dynamically allocated memory for the modified URL is freed.</p>
<dl class="section note"><dt>Note</dt><dd>The function assumes the existence of a global template string <code>template_batch_get_url</code>, as well as the utility function <code>replaceWord</code> for string substitution. </dd></dl>

</div>
</div>
<a id="a64ea3261973ef7a6fac53badd1ef0835"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64ea3261973ef7a6fac53badd1ef0835">&#9670;&nbsp;</a></span>batchUpdateSheet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void batchUpdateSheet </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>sheetId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>values</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs a batch update on a Google Sheet by sending a POST request with specified parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sheetId</td><td>Pointer to the string containing the ID of the Google Sheet to be updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">range</td><td>Pointer to the string specifying the range of cells to update. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">values</td><td>Pointer to the string containing the values to be inserted into the specified range.</td></tr>
  </table>
  </dd>
</dl>
<p>This function constructs a URL and query string for a batch update request to the Google Sheets API. The URL and query template strings are modified to include the provided <code>sheetId</code>, <code>range</code>, and <code>values</code>. The modified URL and query are then passed to the <code>sheetAPI</code> function, which handles the API request. After the request is completed, the dynamically allocated memory for the modified URL and query strings is freed.</p>
<dl class="section note"><dt>Note</dt><dd>The function assumes the existence of global template strings <code>template_batch_update_url</code> and <code>template_batch_update_query</code>, as well as the utility function <code>replaceWord</code> for string substitution. </dd></dl>

</div>
</div>
<a id="a82b6dc3d32e005909fad4c54a0de845b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82b6dc3d32e005909fad4c54a0de845b">&#9670;&nbsp;</a></span>refreshOAuthToken()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void refreshOAuthToken </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Refreshes the OAuth token by sending a POST request to the Google OAuth 2.0 server. </p>
<p>This function sends a POST request to the Google OAuth 2.0 token endpoint to refresh the access token using the refresh token. The required client ID, client secret, and refresh token are retrieved from environment variables (<code>GOOGLE_CLIENT_ID</code>, <code>GOOGLE_CLIENT_SECRET</code>, <code>GOOGLE_REFRESH_TOKEN</code>). The response, which includes the new access token, is handled by the <code>writeCallback</code> function and stored in a memory buffer. The function also handles error checking and resource cleanup after the request.</p>
<dl class="section note"><dt>Note</dt><dd>The function assumes that the environment variables <code>GOOGLE_CLIENT_ID</code>, <code>GOOGLE_CLIENT_SECRET</code>, and <code>GOOGLE_REFRESH_TOKEN</code> are set. It also assumes the existence of a global variable <code>chunk</code> of type <code>struct memory</code> for storing the response, and the presence of the <code>writeCallback</code> function to handle the response. </dd></dl>

</div>
</div>
<a id="a47426036fb44318f0899346238a48b02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47426036fb44318f0899346238a48b02">&#9670;&nbsp;</a></span>sheetApi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sheetApi </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>url</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>requestType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Makes an API request to a specified URL using the provided query and request type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">query</td><td>Pointer to the query string to be sent in the request body. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">url</td><td>Pointer to the URL to which the request is made. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">requestType</td><td>Pointer to the request type (e.g., "PUT", "POST").</td></tr>
  </table>
  </dd>
</dl>
<p>This function initializes a cURL session to perform an HTTP request to a given URL. It sets the necessary HTTP headers, including an authorization token, and sends the query data as the request body. The response from the server is handled by the <code>writeCallback</code> function, which stores the response in a memory buffer. The cURL session and associated resources are cleaned up after the request is completed.</p>
<dl class="section note"><dt>Note</dt><dd>The function assumes that a global variable <code>chunk</code> of type <code>struct memory</code> is defined and used to store the server's response. The authorization token <code>SHEET_API_TOKEN</code> must be defined as a macro or global variable elsewhere in the program. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
