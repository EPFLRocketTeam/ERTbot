<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ERTbot: src/sheetAPI.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ERTbot
   </div>
   <div id="projectbrief">Bot used to automate and enhance certain processes at the EPFL Rocket Team</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">sheetAPI.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains all of the functions which are only used to interact with the Google Sheets APIs.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="struct_8h_source.html">../include/struct.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="api_8h_source.html">../include/api.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="config_8h_source.html">../include/config.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="features_8h_source.html">../include/features.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="githubAPI_8h_source.html">../include/githubAPI.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="helperFunctions_8h_source.html">../include/helperFunctions.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="markdownToPDF_8h_source.html">../include/markdownToPDF.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="slackAPI_8h_source.html">../include/slackAPI.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stringTools_8h_source.html">../include/stringTools.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="wikiAPI_8h_source.html">../include/wikiAPI.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sheetAPI_8h_source.html">../include/sheetAPI.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for sheetAPI.c:</div>
<div class="dyncontent">
<div class="center"><img src="sheetAPI_8c__incl.png" border="0" usemap="#asrc_2sheetAPI_8c" alt=""/></div>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a62c14b08725bb9b441e585eff9e5cecc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sheetAPI_8c.html#a62c14b08725bb9b441e585eff9e5cecc">sheetAPI</a> (char *query, char *url, char *requestType)</td></tr>
<tr class="separator:a62c14b08725bb9b441e585eff9e5cecc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64ea3261973ef7a6fac53badd1ef0835"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sheetAPI_8c.html#a64ea3261973ef7a6fac53badd1ef0835">batchUpdateSheet</a> (char *sheetId, char *range, char *values)</td></tr>
<tr class="memdesc:a64ea3261973ef7a6fac53badd1ef0835"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs a batch update on a Google Sheet by sending a POST request with specified parameters.  <a href="sheetAPI_8c.html#a64ea3261973ef7a6fac53badd1ef0835">More...</a><br /></td></tr>
<tr class="separator:a64ea3261973ef7a6fac53badd1ef0835"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca34990c43115f79931b7f989130798f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sheetAPI_8c.html#aca34990c43115f79931b7f989130798f">batchGetSheet</a> (char *sheetId, char *range)</td></tr>
<tr class="memdesc:aca34990c43115f79931b7f989130798f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves data from a specified range in a Google Sheet by sending a GET request.  <a href="sheetAPI_8c.html#aca34990c43115f79931b7f989130798f">More...</a><br /></td></tr>
<tr class="separator:aca34990c43115f79931b7f989130798f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82b6dc3d32e005909fad4c54a0de845b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sheetAPI_8c.html#a82b6dc3d32e005909fad4c54a0de845b">refreshOAuthToken</a> ()</td></tr>
<tr class="memdesc:a82b6dc3d32e005909fad4c54a0de845b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refreshes the OAuth token by sending a POST request to the Google OAuth 2.0 server.  <a href="sheetAPI_8c.html#a82b6dc3d32e005909fad4c54a0de845b">More...</a><br /></td></tr>
<tr class="separator:a82b6dc3d32e005909fad4c54a0de845b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:adb08e5cb005ae9f8a8790371c6408f61"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sheetAPI_8c.html#adb08e5cb005ae9f8a8790371c6408f61">template_batch_update_url</a> = &quot;https://sheets.googleapis.com/v4/spreadsheets/DefaultSheetID/values:batchUpdate&quot;</td></tr>
<tr class="separator:adb08e5cb005ae9f8a8790371c6408f61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c568657ab9cf37b926db1cd32897f63"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sheetAPI_8c.html#a0c568657ab9cf37b926db1cd32897f63">template_batch_get_url</a> = &quot;https://sheets.googleapis.com/v4/spreadsheets/DefaultSheetID/values/DefaultRange&quot;</td></tr>
<tr class="separator:a0c568657ab9cf37b926db1cd32897f63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcea0b0ae4b0caed02d35564d6772d34"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sheetAPI_8c.html#adcea0b0ae4b0caed02d35564d6772d34">template_batch_update_query</a> = &quot;{\&quot;valueInputOption\&quot;: \&quot;USER_ENTERED\&quot;,\&quot;data\&quot;: [{\&quot;range\&quot;: \&quot;DefaultRange\&quot;,\&quot;majorDimension\&quot;: \&quot;ROWS\&quot;,\&quot;values\&quot;: DefaultValues}],\&quot;includeValuesInResponse\&quot;: true,\&quot;responseValueRenderOption\&quot;: \&quot;FORMATTED_VALUE\&quot;,\&quot;responseDateTimeRenderOption\&quot;: \&quot;SERIAL_NUMBER\&quot;}&quot;</td></tr>
<tr class="separator:adcea0b0ae4b0caed02d35564d6772d34"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains all of the functions which are only used to interact with the Google Sheets APIs. </p>
<dl class="section author"><dt>Author</dt><dd>Ryan Svoboda (<a href="#" onclick="location.href='mai'+'lto:'+'rya'+'n.'+'svo'+'bo'+'da@'+'ep'+'fl.'+'ch'; return false;">ryan.<span style="display: none;">.nosp@m.</span>svob<span style="display: none;">.nosp@m.</span>oda@e<span style="display: none;">.nosp@m.</span>pfl.<span style="display: none;">.nosp@m.</span>ch</a>) </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aca34990c43115f79931b7f989130798f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca34990c43115f79931b7f989130798f">&#9670;&nbsp;</a></span>batchGetSheet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void batchGetSheet </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>sheetId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>range</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves data from a specified range in a Google Sheet by sending a GET request. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sheetId</td><td>Pointer to the string containing the ID of the Google Sheet to be accessed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">range</td><td>Pointer to the string specifying the range of cells to retrieve.</td></tr>
  </table>
  </dd>
</dl>
<p>This function constructs a URL for a GET request to the Google Sheets API by modifying a template URL to include the provided <code>sheetId</code> and <code>range</code>. The constructed URL is then passed to the <code>sheetAPI</code> function, which handles the API request. Since this is a GET request, the query string is left empty. After the request is completed, the dynamically allocated memory for the modified URL is freed.</p>
<dl class="section note"><dt>Note</dt><dd>The function assumes the existence of a global template string <code>template_batch_get_url</code>, as well as the utility function <code>replaceWord</code> for string substitution. </dd></dl>

</div>
</div>
<a id="a64ea3261973ef7a6fac53badd1ef0835"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64ea3261973ef7a6fac53badd1ef0835">&#9670;&nbsp;</a></span>batchUpdateSheet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void batchUpdateSheet </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>sheetId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>values</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs a batch update on a Google Sheet by sending a POST request with specified parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sheetId</td><td>Pointer to the string containing the ID of the Google Sheet to be updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">range</td><td>Pointer to the string specifying the range of cells to update. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">values</td><td>Pointer to the string containing the values to be inserted into the specified range.</td></tr>
  </table>
  </dd>
</dl>
<p>This function constructs a URL and query string for a batch update request to the Google Sheets API. The URL and query template strings are modified to include the provided <code>sheetId</code>, <code>range</code>, and <code>values</code>. The modified URL and query are then passed to the <code>sheetAPI</code> function, which handles the API request. After the request is completed, the dynamically allocated memory for the modified URL and query strings is freed.</p>
<dl class="section note"><dt>Note</dt><dd>The function assumes the existence of global template strings <code>template_batch_update_url</code> and <code>template_batch_update_query</code>, as well as the utility function <code>replaceWord</code> for string substitution. </dd></dl>

</div>
</div>
<a id="a82b6dc3d32e005909fad4c54a0de845b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82b6dc3d32e005909fad4c54a0de845b">&#9670;&nbsp;</a></span>refreshOAuthToken()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void refreshOAuthToken </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Refreshes the OAuth token by sending a POST request to the Google OAuth 2.0 server. </p>
<p>This function sends a POST request to the Google OAuth 2.0 token endpoint to refresh the access token using the refresh token. The required client ID, client secret, and refresh token are retrieved from environment variables (<code>GOOGLE_CLIENT_ID</code>, <code>GOOGLE_CLIENT_SECRET</code>, <code>GOOGLE_REFRESH_TOKEN</code>). The response, which includes the new access token, is handled by the <code>writeCallback</code> function and stored in a memory buffer. The function also handles error checking and resource cleanup after the request.</p>
<dl class="section note"><dt>Note</dt><dd>The function assumes that the environment variables <code>GOOGLE_CLIENT_ID</code>, <code>GOOGLE_CLIENT_SECRET</code>, and <code>GOOGLE_REFRESH_TOKEN</code> are set. It also assumes the existence of a global variable <code>chunk</code> of type <code>struct memory</code> for storing the response, and the presence of the <code>writeCallback</code> function to handle the response. </dd></dl>

</div>
</div>
<a id="a62c14b08725bb9b441e585eff9e5cecc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62c14b08725bb9b441e585eff9e5cecc">&#9670;&nbsp;</a></span>sheetAPI()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sheetAPI </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>url</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>requestType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0c568657ab9cf37b926db1cd32897f63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c568657ab9cf37b926db1cd32897f63">&#9670;&nbsp;</a></span>template_batch_get_url</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* template_batch_get_url = &quot;https://sheets.googleapis.com/v4/spreadsheets/DefaultSheetID/values/DefaultRange&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adcea0b0ae4b0caed02d35564d6772d34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcea0b0ae4b0caed02d35564d6772d34">&#9670;&nbsp;</a></span>template_batch_update_query</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* template_batch_update_query = &quot;{\&quot;valueInputOption\&quot;: \&quot;USER_ENTERED\&quot;,\&quot;data\&quot;: [{\&quot;range\&quot;: \&quot;DefaultRange\&quot;,\&quot;majorDimension\&quot;: \&quot;ROWS\&quot;,\&quot;values\&quot;: DefaultValues}],\&quot;includeValuesInResponse\&quot;: true,\&quot;responseValueRenderOption\&quot;: \&quot;FORMATTED_VALUE\&quot;,\&quot;responseDateTimeRenderOption\&quot;: \&quot;SERIAL_NUMBER\&quot;}&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adb08e5cb005ae9f8a8790371c6408f61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb08e5cb005ae9f8a8790371c6408f61">&#9670;&nbsp;</a></span>template_batch_update_url</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* template_batch_update_url = &quot;https://sheets.googleapis.com/v4/spreadsheets/DefaultSheetID/values:batchUpdate&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
